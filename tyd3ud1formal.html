<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Technical Object Analysis - AI Generator</title>
    <!-- Tailwind CSS -->
    <script src="https://cdn.jsdelivr.net/npm/@tailwindcss/browser@4"></script>
    <!-- HTML2PDF Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        /* Ajustes básicos */
        body { -webkit-print-color-adjust: exact; }
        
        textarea {
            resize: none; 
            overflow: hidden; 
            min-height: 80px;
            transition: height 0.2s;
        }

        /* Ocultar el botón SOLO si se imprime usando Ctrl+P (navegador), no en pantalla */
        @media print {
            #download-btn-container {
                display: none !important;
            }
        }

        /* Estilo para el contenido en el PDF (limpio y legible) */
        .pdf-text-content {
            white-space: pre-wrap; 
            font-family: 'ui-sans-serif', system-ui, sans-serif;
            color: #1f2937; 
            background-color: #f9fafb; 
            padding: 0.75rem;
            border-radius: 0.375rem;
            border: 1px solid #e5e7eb; 
            width: 100%;
            display: block;
            margin-bottom: 5px;
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen py-10 font-sans text-gray-800">

    <!-- Botón Flotante (Fuera del contenedor imprimible) -->
    <div id="download-btn-container" class="fixed bottom-8 right-8 z-50">
        <button onclick="downloadPDF()" class="bg-indigo-600 hover:bg-indigo-700 text-white font-bold py-4 px-6 rounded-full shadow-lg transform transition hover:-translate-y-1 flex items-center gap-3 border-2 border-white">
            <i class="fa-solid fa-file-pdf text-2xl"></i>
            <span>Descargar PDF</span>
        </button>
    </div>

    <!-- Contenedor Principal (Esto es lo que se imprime) -->
    <div id="document-content" class="max-w-4xl mx-auto bg-white shadow-xl rounded-xl overflow-hidden border border-gray-200">
        
        <!-- Header -->
        <div class="bg-indigo-900 text-white p-8 border-b-4 border-cyan-400">
            <div class="flex justify-between items-start">
                <div>
                    <h1 class="text-3xl font-bold uppercase tracking-wider">Technical Object Analysis</h1>
                    <p class="text-indigo-200 mt-2 text-lg">Automated Scale Model | Unit 1: The Technological Process</p>
                </div>
                <div class="text-right hidden sm:block">
                    <span class="bg-indigo-800 text-xs px-3 py-1 rounded uppercase tracking-widest">3º ESO</span>
                </div>
            </div>
        </div>

        <!-- Content Form -->
        <div class="p-8 space-y-8">
            <!-- INTRODUCTION / INSTRUCTIONS (New) -->
            <div class="bg-blue-50 border-l-4 border-blue-500 p-4">
                <p class="text-sm text-blue-800">
                    <strong>Instructions:</strong> Complete this detailed analysis in <strong>English</strong>. The information you provide here will be used later in the project. Be precise, technical, and descriptive to get the best result.
                </p>
            </div>

            <!-- DATOS DEL ALUMNO -->
            <div class="bg-indigo-50 p-6 rounded-lg border border-indigo-100">
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                        <label class="block text-xs font-bold text-indigo-800 uppercase mb-2"><i class="fa-solid fa-user mr-1"></i> Student Name</label>
                        <input type="text" placeholder="Your Name" class="w-full bg-white border border-indigo-200 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 font-medium input-field">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-indigo-800 uppercase mb-2"><i class="fa-solid fa-users mr-1"></i> Group</label>
                        <input type="text" placeholder="e.g., 3ºA - Group 1" class="w-full bg-white border border-indigo-200 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 font-medium input-field">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-indigo-800 uppercase mb-2"><i class="fa-solid fa-tag mr-1"></i> Project Title</label>
                        <input type="text" placeholder="e.g., Eco-Smart Home" class="w-full bg-white border border-indigo-200 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 font-medium input-field">
                    </div>
                </div>
            </div>

            <!-- SECCIÓN 0: GENERAL DESCRIPTION (New) -->
            <section>
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-gray-200">
                    <span class="bg-indigo-100 text-indigo-700 font-bold py-1 px-3 rounded text-sm">00</span>
                    <h2 class="text-xl font-bold text-gray-800 uppercase">General Project Description</h2>
                </div>
                <p class="text-sm text-gray-500 italic mb-4">Briefly describe your project in 2-3 sentences. What is it and what problem does it solve?</p>
                
                <div>
                    <textarea oninput="autoResize(this)" placeholder="e.g., This project is a scale model of a bioclimatic house designed to reduce energy consumption. It features automated blinds that close when the sun is too strong..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                </div>
            </section>


            <!-- SECCIÓN 1 -->
            <section>
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-gray-200">
                    <span class="bg-indigo-100 text-indigo-700 font-bold py-1 px-3 rounded text-sm">01</span>
                    <h2 class="text-xl font-bold text-gray-800 uppercase">Formal Analysis (Shape & Structure)</h2>
                </div>
                <p class="text-sm text-gray-500 italic mb-6">Focus on the geometry, physical dimensions, and structural assembly.</p>

                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Overall Geometry</label>
                        <textarea oninput="autoResize(this)" placeholder="e.g., Rectangular prism with a flat roof..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Dimensions (mm)</label>
                        <textarea oninput="autoResize(this)" placeholder="Height: ___mm, Width: ___mm..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Assembly Method</label>
                        <textarea oninput="autoResize(this)" placeholder="e.g., Hot glue and interlocking joints..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Scale Ratio</label>
                        <textarea oninput="autoResize(this)" placeholder="e.g., 1:20" class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                    
                </div>
            </section>

            <!-- SECCIÓN 2 -->
            <section>
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-gray-200">
                    <span class="bg-indigo-100 text-indigo-700 font-bold py-1 px-3 rounded text-sm">02</span>
                    <h2 class="text-xl font-bold text-gray-800 uppercase">Technical Analysis (Materials)</h2>
                </div>
                <p class="text-sm text-gray-500 italic mb-6">Analyze the materials used, surface finishes, and the technical principles applied.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Structural Materials</label>
                        <textarea oninput="autoResize(this)" placeholder="e.g., 3mm Plywood, corrugated cardboard..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Surface Finishes</label>
                        <textarea oninput="autoResize(this)" placeholder="e.g., Acrylic matte paint, exposed wood..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Technical Principles</label>
                        <textarea oninput="autoResize(this)" placeholder="e.g., Electric circuit logic..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Standardized Parts</label>
                        <textarea oninput="autoResize(this)" placeholder="e.g., M3 screws, micro-servos..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                </div>
            </section>

            <!-- SECCIÓN 3 -->
            <section>
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-gray-200">
                    <span class="bg-indigo-100 text-indigo-700 font-bold py-1 px-3 rounded text-sm">03</span>
                    <h2 class="text-xl font-bold text-gray-800 uppercase">Functional Analysis (Purpose & Motion)</h2>
                </div>
                <p class="text-sm text-gray-500 italic mb-6">Define the primary utility, how the mechanism moves, and the control system logic.</p>
                <div class="space-y-4">
                    <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Main Function</label>
                            <textarea oninput="autoResize(this)" placeholder="e.g., Energy-efficient smart home prototype" class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                    <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Moving Mechanism</label>
                            <textarea oninput="autoResize(this)" placeholder="Describe the mechanism clearly. e.g., A motorized sliding garage door..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Control System</label>
                            <textarea oninput="autoResize(this)" placeholder="e.g., Arduino Uno R3 with sensors..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                        </div>
                        <div>
                            <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Operational Workflow</label>
                            <textarea oninput="autoResize(this)" placeholder="e.g., When sensor detects..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SECCIÓN 4 -->
            <section>
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-gray-200">
                    <span class="bg-indigo-100 text-indigo-700 font-bold py-1 px-3 rounded text-sm">04</span>
                    <h2 class="text-xl font-bold text-gray-800 uppercase">Aesthetic Analysis (Visual Style)</h2>
                </div>
                <p class="text-sm text-gray-500 italic mb-6">Describe the visual style, color palette, and the sensations the object conveys.</p>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Architectural Style</label>
                        <textarea oninput="autoResize(this)" placeholder="e.g., Industrial Loft" class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Color Palette (3 colors)</label>
                        <textarea oninput="autoResize(this)" placeholder="e.g., Charcoal gray, natural oak, cyan" class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Atmosphere</label>
                        <textarea oninput="autoResize(this)" placeholder="e.g., Warm internal lighting..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Ergonomics</label>
                        <textarea oninput="autoResize(this)" placeholder="e.g., Removable roof..." class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 input-field"></textarea>
                    </div>
                </div>
            </section>

             <!-- SECCIÓN 5 -->
             <section>
                <div class="flex items-center gap-3 mb-4 border-b pb-2 border-gray-200">
                    <span class="bg-indigo-100 text-indigo-700 font-bold py-1 px-3 rounded text-sm">05</span>
                    <h2 class="text-xl font-bold text-gray-800 uppercase">Socio-Economic Analysis</h2>
                </div>
                <p class="text-sm text-gray-500 italic mb-6">Evaluate the environmental impact, cost estimation, and the concept behind the project.</p>
                <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Concept</label>
                        <textarea oninput="autoResize(this)" class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 h-24 input-field"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Environmental Impact</label>
                        <textarea oninput="autoResize(this)" class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 h-24 input-field"></textarea>
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-500 uppercase mb-2">Estimated Cost</label>
                        <textarea oninput="autoResize(this)" class="w-full bg-gray-50 border border-gray-300 rounded p-3 text-gray-700 focus:outline-none focus:ring-2 focus:ring-indigo-500 h-24 input-field"></textarea>
                    </div>
                </div>
            </section>

            <!-- Instructions Footer (Visible only on web, hidden in PDF logic via JS) 
            <div id="instructions-footer" class="mt-10 p-6 bg-gray-800 text-gray-300 rounded-lg text-sm border-l-4 border-cyan-400">
                <h3 class="text-white font-bold mb-2 uppercase flex items-center gap-2">
                    <i class="fa-solid fa-robot"></i> Next Steps for AI Generation
                </h3>
                <ol class="list-decimal pl-5 space-y-2">
                    <li>Fill out all the fields in English.</li>
                    <li>Click the <strong>Descargar PDF</strong> button.</li>
                    <li>Upload the PDF to your AI Tool (Gemini, ChatGPT) or copy the text.</li>
                    <li>Use this prompt: <em class="text-cyan-300">"Based on the attached Technical Analysis, generate a high-quality, realistic image of this architectural scale model. Show it on a clean workshop table with realistic textures and studio lighting. Ensure the moving mechanism is visible."</em></li>
                </ol>
            </div>
            -->

        </div>
        
        <!-- Footer for PDF only (Hidden initially) -->
        <div id="pdf-footer" class="bg-indigo-900 text-white p-4 text-center text-xs hidden">
            Technology and Digitalisation 3º ESO
        </div>
    </div>

    <script>
        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = textarea.scrollHeight + 'px';
        }

        function downloadPDF() {
            const originalElement = document.getElementById('document-content');
            
            // 1. Clonar el elemento original
            const clone = originalElement.cloneNode(true);

            // IMPORTANTE: Quitar clases que puedan recortar contenido en el clon
            clone.classList.remove('overflow-hidden');
            clone.classList.remove('shadow-xl'); // Quitar sombra para impresión limpia
            clone.style.height = 'auto'; // Asegurar altura automática
            
            // 2. Transformar inputs/textareas en el clon a texto estático
            const inputs = clone.querySelectorAll('input.input-field');
            const textareas = clone.querySelectorAll('textarea.input-field');

            inputs.forEach(input => {
                const div = document.createElement('div');
                div.className = 'pdf-text-content';
                div.textContent = input.value || ''; 
                if(input.parentNode) input.parentNode.replaceChild(div, input);
            });

            textareas.forEach(textarea => {
                const div = document.createElement('div');
                div.className = 'pdf-text-content';
                div.textContent = textarea.value || '';
                if(textarea.parentNode) textarea.parentNode.replaceChild(div, textarea);
            });

            // 3. Ocultar instrucciones en el PDF
            const instructions = clone.querySelector('#instructions-footer');
            if(instructions) instructions.style.display = 'none';
            
            // Mostrar footer del PDF
            const pdfFooter = clone.querySelector('#pdf-footer');
            if(pdfFooter) pdfFooter.classList.remove('hidden');

            // 4. Crear un contenedor temporal fuera de pantalla pero EN EL DOM
            // Esto es crucial para que html2pdf calcule bien la altura total
            const container = document.createElement('div');
            container.style.position = 'absolute';
            container.style.top = '-9999px';
            container.style.left = '0';
            container.style.width = originalElement.offsetWidth + 'px'; // Mantener el mismo ancho
            container.appendChild(clone);
            document.body.appendChild(container);

            // 5. Configurar PDF
            const opt = {
                margin:       [0.3, 0.3], 
                filename:     'Technical_Analysis_Model.pdf',
                image:        { type: 'jpeg', quality: 0.98 },
                html2canvas:  { scale: 2, useCORS: true, scrollY: 0 }, 
                jsPDF:        { unit: 'in', format: 'a4', orientation: 'portrait' },
                pagebreak:    { mode: ['css', 'legacy'] }
            };

            // 6. Generar y limpiar
            html2pdf().set(opt).from(clone).save().then(() => {
                document.body.removeChild(container);
            });
        }
    </script>
</body>
</html>
