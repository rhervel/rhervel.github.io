<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Conector Curricular TYD 3º ESO</title>
    
    <!-- React y ReactDOM -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
    
    <!-- Babel para procesar JSX -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* Animaciones suaves */
        .fade-in {
            animation: fadeIn 0.3s ease-in-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        /* Estilos de scroll personalizados */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f1f1; 
        }
        ::-webkit-scrollbar-thumb {
            background: #c7c7c7; 
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8; 
        }
    </style>
</head>
<body class="bg-gray-100 min-h-screen font-sans text-slate-800">
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useMemo } = React;

        // --- ICONOS SVG (Reemplazo de Lucide para versión Standalone) ---
        const IconBookOpen = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-indigo-500"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg>
        );
        const IconCheck = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="3" strokeLinecap="round" strokeLinejoin="round" className="text-white"><polyline points="20 6 9 17 4 12"/></svg>
        );
        const IconRefresh = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 21h5v-5"/></svg>
        );
        const IconCopy = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><rect x="9" y="9" width="13" height="13" rx="2" ry="2"/><path d="M5 15H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h9a2 2 0 0 1 2 2v1"/></svg>
        );
        const IconInfo = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="48" height="48" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="mx-auto mb-3 opacity-50"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>
        );
        const IconLayers = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-indigo-600"><polygon points="12 2 2 7 12 12 22 7 12 2"/><polyline points="2 17 12 22 22 17"/><polyline points="2 12 12 17 22 12"/></svg>
        );
        const IconAward = () => (
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" className="text-yellow-400"><circle cx="12" cy="8" r="7"/><polyline points="8.21 13.89 7 23 12 20 17 23 15.79 13.88"/></svg>
        );

        // --- DATOS ---
        const CRITERIOS_DB = {
            "1.1": "Definir problemas o necesidades planteadas, buscando y contrastando información procedente de diferentes fuentes de manera crítica y segura, evaluando su fiabilidad y pertinencia.",
            "1.2": "Comprender y examinar productos tecnológicos de uso habitual a través del análisis de objetos y sistemas, empleando el método científico y utilizando herramientas de simulación en la construcción de conocimiento.",
            "1.3": "Adoptar medidas preventivas para la protección de los dispositivos, los datos y la salud personal, identificando problemas y riesgos relacionados con el uso de la tecnología y analizándolos de manera ética y crítica.",
            "2.1": "Idear y diseñar soluciones eficaces, innovadoras y sostenibles a problemas definidos, aplicando conceptos, técnicas y procedimientos interdisciplinares, así como criterios de sostenibilidad, con actitud emprendedora, perseverante y creativa.",
            "2.2": "Seleccionar, planificar y organizar los materiales y herramientas, así como las tareas necesarias para la construcción de una solución a un problema planteado, trabajando individualmente o en grupo de manera cooperativa y colaborativa.",
            "3.1": "Fabricar objetos o modelos mediante la manipulación y conformación de materiales, empleando herramientas y máquinas adecuadas, aplicando los fundamentos de estructuras, mecanismos, electricidad y electrónica y respetando las normas de seguridad y salud correspondientes.",
            "4.1": "Representar y comunicar el proceso de creación de un producto, desde su diseño hasta su difusión, elaborando documentación técnica y gráfica con la ayuda de herramientas digitales, empleando los formatos y el vocabulario técnico adecuados, de manera colaborativa, tanto presencialmente como en remoto.",
            "5.1": "Describir, interpretar y diseñar soluciones a problemas informáticos a través de algoritmos y diagramas de flujo, aplicando los elementos y técnicas de programación de manera creativa.",
            "5.2": "Programar aplicaciones sencillas para distintos dispositivos como por ejemplo ordenadores, dispositivos y móviles, empleando los elementos de programación de manera apropiada y aplicando herramientas de edición, así como módulos de inteligencia artificial que añadan funcionalidades a la solución.",
            "5.3": "Automatizar procesos, máquinas y objetos de manera autónoma, con conexión a internet, mediante el análisis, construcción y programación de robots y sistemas de control.",
            "6.1": "Hacer un uso eficiente y seguro de los dispositivos digitales de uso cotidiano en la resolución de problemas sencillos, analizando los componentes y los sistemas de comunicación, conociendo los riesgos y adoptando medidas de seguridad para la protección de datos y equipos.",
            "6.2": "Crear contenidos, elaborar materiales y difundirlos en distintas plataformas, configurando correctamente las herramientas digitales habituales del entorno de aprendizaje, ajustándolas a sus necesidades y respetando los derechos de autor y la etiqueta digital.",
            "6.3": "Organizar la información de manera estructurada, aplicando técnicas de almacenamiento seguro.",
            "7.1": "Reconocer la influencia de la actividad tecnológica en la sociedad y en la sostenibilidad ambiental, a lo largo de su historia, identificando sus aportaciones y repercusiones y valorando su importancia para el desarrollo sostenible, contextualizando sus aplicaciones en nuestra comunidad.",
            "7.2": "Identificar las aportaciones básicas de las tecnologías emergentes al bienestar, a la igualdad social y a la disminución del impacto ambiental del entorno más cercano, en especial de Andalucía, haciendo un uso responsable y ético de las mismas."
        };

        const SABERES_DB = [
            { id: "TYD.3.A.1", bloque: "A", texto: "Estrategias, técnicas y marcos de resolución de problemas sencillos en diferentes contextos y sus fases.", criterios: ["1.1", "2.1"] },
            { id: "TYD.3.A.2", bloque: "A", texto: "Estrategias de búsqueda crítica de información durante la investigación y definición de problemas sencillos planteados.", criterios: ["1.1", "1.2"] },
            { id: "TYD.3.A.3", bloque: "A", texto: "Electricidad y electrónica básica: montaje, esquemas, circuitos físicos/simulados. Magnitudes, simbología e interpretación.", criterios: ["1.2", "3.1"] },
            { id: "TYD.3.A.4", bloque: "A", texto: "Herramientas y técnicas de manipulación/mecanizado. Introducción a fabricación digital. Normas de seguridad.", criterios: ["1.3", "2.2", "3.1"] },
            { id: "TYD.3.A.5", bloque: "A", texto: "Emprendimiento, resiliencia, perseverancia y creatividad para abordar problemas sencillos (perspectiva interdisciplinar).", criterios: ["1.1", "2.1"] },
            { id: "TYD.3.B.1", bloque: "B", texto: "Técnicas de representación gráfica: acotación, escalas, boceto, croquis. Vistas normalizadas.", criterios: ["4.1"] },
            { id: "TYD.3.B.2", bloque: "B", texto: "Aplicaciones CAD (2D y 3D) para esquemas, circuitos, planos y objetos básicos.", criterios: ["4.1"] },
            { id: "TYD.3.B.3", bloque: "B", texto: "Herramientas digitales para elaboración, publicación y difusión de documentación técnica y multimedia.", criterios: ["4.1"] },
            { id: "TYD.3.C.1", bloque: "C", texto: "Aplicaciones informáticas sencillas para ordenador/móvil e introducción a la IA.", criterios: ["5.1", "5.2"] },
            { id: "TYD.3.C.2", bloque: "C", texto: "Fundamentos de la robótica: montaje y control programado de robots simples (físicos o simulados).", criterios: ["5.1", "5.2", "5.3"] },
            { id: "TYD.3.C.3", bloque: "C", texto: "Autoconfianza e iniciativa: el error, la reevaluación y la depuración de errores en el aprendizaje.", criterios: ["1.1", "5.1", "5.3"] },
            { id: "TYD.3.D.1", bloque: "D", texto: "Sistemas de comunicación digital, transmisión de datos y tecnologías inalámbricas.", criterios: ["6.1"] },
            { id: "TYD.3.D.2", bloque: "D", texto: "Herramientas de edición y creación de contenidos: instalación, configuración, uso responsable. Propiedad intelectual.", criterios: ["4.1", "6.2"] },
            { id: "TYD.3.D.3", bloque: "D", texto: "Técnicas de tratamiento, organización y almacenamiento seguro de la información. Copias de seguridad.", criterios: ["6.1", "6.3"] },
            { id: "TYD.3.D.4", bloque: "D", texto: "Seguridad en la red: riesgos, amenazas, protección de datos. Bienestar digital (ciberacoso, adicciones, etc.).", criterios: ["6.1", "6.2", "6.3"] },
            { id: "TYD.3.E.1", bloque: "E", texto: "Desarrollo tecnológico: innovación, obsolescencia, impacto social/ambiental. Ética. Tecnología en Andalucía.", criterios: ["7.1", "7.2"] },
            { id: "TYD.3.E.2", bloque: "E", texto: "Tecnología sostenible. Valoración crítica y contribución a los ODS.", criterios: ["1.3", "7.1", "7.2"] }
        ];

        // --- COMPONENTE PRINCIPAL ---
        const EvaluadorTYD = () => {
            const [selectedSaberes, setSelectedSaberes] = useState([]);

            const toggleSaber = (id) => {
                setSelectedSaberes(prev => 
                    prev.includes(id) ? prev.filter(item => item !== id) : [...prev, id]
                );
            };

            const resetSelection = () => setSelectedSaberes([]);

            const resultados = useMemo(() => {
                const criteriosSet = new Set();
                const mapCriterioToSaberes = {};

                selectedSaberes.forEach(saberId => {
                    const saber = SABERES_DB.find(s => s.id === saberId);
                    if (saber) {
                        saber.criterios.forEach(critId => {
                            criteriosSet.add(critId);
                            if (!mapCriterioToSaberes[critId]) mapCriterioToSaberes[critId] = [];
                            mapCriterioToSaberes[critId].push(saberId);
                        });
                    }
                });

                const sortedCriterios = Array.from(criteriosSet).sort((a, b) => {
                    const [majA, minA] = a.split('.').map(Number);
                    const [majB, minB] = b.split('.').map(Number);
                    if (majA !== majB) return majA - majB;
                    return minA - minB;
                });

                return {
                    lista: sortedCriterios,
                    mapa: mapCriterioToSaberes
                };
            }, [selectedSaberes]);

            const copyToClipboard = () => {
                const text = resultados.lista.map(id => `${id} - ${CRITERIOS_DB[id]}`).join('\n\n');
                navigator.clipboard.writeText(text);
                alert("Criterios copiados al portapapeles");
            };

            const getBlockColor = (bloque) => {
                switch(bloque) {
                    case 'A': return 'border-l-4 border-blue-500 bg-blue-50';
                    case 'B': return 'border-l-4 border-green-500 bg-green-50';
                    case 'C': return 'border-l-4 border-purple-500 bg-purple-50';
                    case 'D': return 'border-l-4 border-orange-500 bg-orange-50';
                    case 'E': return 'border-l-4 border-pink-500 bg-pink-50';
                    default: return 'bg-gray-50';
                }
            };

            const getBlockBadge = (bloque) => {
                switch(bloque) {
                    case 'A': return 'text-blue-700 bg-blue-100';
                    case 'B': return 'text-green-700 bg-green-100';
                    case 'C': return 'text-purple-700 bg-purple-100';
                    case 'D': return 'text-orange-700 bg-orange-100';
                    case 'E': return 'text-pink-700 bg-pink-100';
                    default: return 'text-gray-700 bg-gray-100';
                }
            };

            return (
                <div className="min-h-screen bg-gray-100 p-4 pb-20">
                    <header className="max-w-7xl mx-auto mb-6 bg-white p-6 rounded-lg shadow-sm border-b-4 border-indigo-600">
                        <h1 className="text-2xl font-bold text-slate-900 flex items-center gap-2">
                            <IconLayers />
                            Conector Curricular TYD 3º ESO
                        </h1>
                        <p className="text-slate-500 mt-2">
                            Selecciona los <strong>Saberes Básicos</strong> para ver sus <strong>Criterios de Evaluación</strong>.
                        </p>
                    </header>

                    <div className="max-w-7xl mx-auto grid grid-cols-1 lg:grid-cols-12 gap-6">
                        
                        {/* COLUMNA IZQUIERDA */}
                        <div className="lg:col-span-7 space-y-4">
                            <div className="flex justify-between items-center mb-2">
                                <h2 className="text-lg font-semibold flex items-center gap-2">
                                    <IconBookOpen />
                                    Saberes Básicos
                                </h2>
                                {selectedSaberes.length > 0 && (
                                    <button 
                                        onClick={resetSelection}
                                        className="text-sm text-red-600 flex items-center gap-1 hover:bg-red-50 px-2 py-1 rounded transition"
                                    >
                                        <IconRefresh /> Resetear
                                    </button>
                                )}
                            </div>

                            <div className="space-y-3">
                                {SABERES_DB.map((saber) => {
                                    const isSelected = selectedSaberes.includes(saber.id);
                                    return (
                                        <div 
                                            key={saber.id}
                                            onClick={() => toggleSaber(saber.id)}
                                            className={`cursor-pointer p-4 rounded-lg shadow-sm transition-all duration-200 border border-transparent hover:shadow-md relative group
                                                ${isSelected ? 'ring-2 ring-indigo-500 bg-white' : 'bg-white hover:border-indigo-200'}
                                                ${getBlockColor(saber.bloque)}
                                            `}
                                        >
                                            <div className="flex items-start gap-3">
                                                <div className={`mt-1 flex-shrink-0 w-6 h-6 rounded border-2 flex items-center justify-center transition-colors
                                                    ${isSelected ? 'bg-indigo-600 border-indigo-600' : 'border-gray-300 bg-white'}
                                                `}>
                                                    {isSelected && <IconCheck />}
                                                </div>
                                                <div>
                                                    <div className="flex items-center gap-2 mb-1">
                                                        <span className="font-mono font-bold text-sm text-slate-700">{saber.id}</span>
                                                        <span className={`text-xs px-2 py-0.5 rounded-full font-medium ${getBlockBadge(saber.bloque)}`}>
                                                            Bloque {saber.bloque}
                                                        </span>
                                                    </div>
                                                    <p className="text-sm text-slate-700 leading-relaxed">{saber.texto}</p>
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>

                        {/* COLUMNA DERECHA */}
                        <div className="lg:col-span-5">
                            <div className="sticky top-6">
                                <div className="bg-white rounded-xl shadow-lg border border-slate-200 overflow-hidden flex flex-col max-h-[calc(100vh-2rem)]">
                                    <div className="p-4 bg-slate-800 text-white flex justify-between items-center">
                                        <h2 className="font-bold flex items-center gap-2">
                                            <IconAward />
                                            Criterios Resultantes
                                            <span className="bg-slate-700 px-2 py-0.5 rounded-full text-xs ml-2">
                                                {resultados.lista.length}
                                            </span>
                                        </h2>
                                        {resultados.lista.length > 0 && (
                                            <button 
                                                onClick={copyToClipboard}
                                                title="Copiar lista"
                                                className="p-2 hover:bg-slate-700 rounded transition-colors"
                                            >
                                                <IconCopy />
                                            </button>
                                        )}
                                    </div>

                                    <div className="p-4 overflow-y-auto bg-slate-50 flex-grow" style={{minHeight: '200px'}}>
                                        {resultados.lista.length === 0 ? (
                                            <div className="text-center py-12 text-slate-400">
                                                <IconInfo />
                                                <p>Selecciona saberes en la izquierda para ver los criterios.</p>
                                            </div>
                                        ) : (
                                            <div className="space-y-4">
                                                {resultados.lista.map(critId => (
                                                    <div key={critId} className="bg-white p-4 rounded-lg shadow-sm border border-slate-200 fade-in">
                                                        <div className="flex items-center gap-2 mb-2">
                                                            <span className="bg-indigo-100 text-indigo-800 font-bold px-2 py-1 rounded text-sm">
                                                                Criterio {critId}
                                                            </span>
                                                        </div>
                                                        <p className="text-slate-700 text-sm mb-3 leading-relaxed">
                                                            {CRITERIOS_DB[critId]}
                                                        </p>
                                                        <div className="border-t pt-2 mt-2">
                                                            <p className="text-xs text-slate-400 mb-1">Origen:</p>
                                                            <div className="flex flex-wrap gap-1">
                                                                {resultados.mapa[critId].map(saberId => (
                                                                    <span key={saberId} className="text-xs bg-slate-100 text-slate-500 px-1.5 py-0.5 rounded border border-slate-200">
                                                                        {saberId}
                                                                    </span>
                                                                ))}
                                                            </div>
                                                        </div>
                                                    </div>
                                                ))}
                                            </div>
                                        )}
                                    </div>
                                    
                                    {resultados.lista.length > 0 && (
                                        <div className="p-3 bg-indigo-50 border-t border-indigo-100 text-xs text-indigo-700 text-center">
                                            TYD 3º ESO - Normativa
                                        </div>
                                    )}
                                </div>
                            </div>
                        </div>

                    </div>
                </div>
            );
        };

        // Renderizado
        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<EvaluadorTYD />);
    </script>
</body>
</html>